getUserDetails:
  handler: lambda/getUserDetails.handler
  name: ${self:service}-getUserDetails-${self:provider.stage}
  layers:
    - { Ref: CommonLayerLambdaLayer }
  role: !GetAtt getUserDetailsRole.Arn
  events:
    - http:
        path: /getUserDetails
        method: post
        cors: true
        integration: LAMBDA
        authorizer:
          type: COGNITO_USER_POOLS
          authorizerId: !Ref ApiAuthorizer
  environment:
    STAGE: ${self:provider.stage}  # Keep stage as an environment variable
    SSM_COGNITO_USER_POOL_ID: "/${self:provider.stage}/cognito/userpool/id"  # Reference SSM parameter name
  package:
    include:
      - lambda/getUserDetails.mjs
